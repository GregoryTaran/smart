<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<base href="../" />
<title>–û –ø—Ä–æ–µ–∫—Ç–µ</title>

<link rel="icon" href="assets/logo400.jpg" />
<link rel="manifest" href="manifest.json" />
<link rel="stylesheet" href="css/main.css" />
<link rel="stylesheet" href="about/about.css" />
 


 <!--
    üß† –ì–ª–æ–±–∞–ª—å–Ω—ã–π bootstrap –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –∫—ç—à–µ–º.
    1) –ü—Ä–æ–±—É–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∫—ç—à –∏–∑ localStorage (–º–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –¥–ª—è UI)
    2) –í —Ñ–æ–Ω–µ –¥—ë—Ä–≥–∞–µ—Ç /api/auth/session, –æ–±–Ω–æ–≤–ª—è–µ—Ç window.SV_AUTH –∏ –∫—ç—à
    3) –í—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö –∫—É–∫–∏ sv_session (—Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞—ë—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø—Ä–∞–≤–¥—ã)
  -->
  <script>
    (function () {
      const AUTH_CACHE_KEY = 'sv.auth.cache.v1';

      // –ë–∞–∑–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –≥–æ—Å—Ç—å
      window.SV_AUTH = {
        isAuthenticated: false,
        userId: null,
        level: 1,
        levelCode: 'guest',
        email: null,
        displayName: null,
        loaded: false
      };

      function normalizeSession(data) {
        data = data || {};
        const isAuth = !!data.is_authenticated;
        let level = Number(data.level);
        if (!Number.isFinite(level) || level <= 0) {
          level = isAuth ? 2 : 1;
        }
        const levelCode = data.level_code || (level === 1 ? 'guest' : 'user');

        return {
          isAuthenticated: isAuth,
          userId: data.user_id ?? null,
          level: level,
          levelCode: levelCode,
          email: data.email ?? null,
          displayName: data.display_name ?? null,
          loaded: true
        };
      }

      function dispatchAuthReady() {
        try {
          document.dispatchEvent(
            new CustomEvent('sv:auth-ready', { detail: window.SV_AUTH })
          );
        } catch (e) {
          console.warn('sv:auth-ready dispatch failed', e);
        }
      }

      function readCache() {
        try {
          const raw = localStorage.getItem(AUTH_CACHE_KEY);
          if (!raw) return null;
          const parsed = JSON.parse(raw);
          if (!parsed || typeof parsed !== 'object') return null;
          return parsed;
        } catch (e) {
          return null;
        }
      }

      function writeCache(session) {
        try {
          localStorage.setItem(AUTH_CACHE_KEY, JSON.stringify(session));
        } catch (e) {
          // localStorage –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Äî —Ç–∏—Ö–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º
        }
      }

      // 1) –ü—ã—Ç–∞–µ–º—Å—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –ø–æ–¥–Ω—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ –∫—ç—à–∞
      (function hydrateFromCache() {
        const cached = readCache();
        if (!cached) return;
        // –°—á–∏—Ç–∞–µ–º –∫—ç—à —É–∂–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º SV_AUTH
        window.SV_AUTH = Object.assign({}, cached, { loaded: true });
        dispatchAuthReady();
      })();

      // 2) –í —Ñ–æ–Ω–µ —Ç—è–Ω–µ–º —Å–≤–µ–∂—É—é —Å–µ—Å—Å–∏—é —Å –±—ç–∫–µ–Ω–¥–∞
      fetch('/api/auth/session', {
        method: 'GET',
        credentials: 'include'
      })
        .then(function (res) {
          if (!res.ok) throw new Error('Auth check failed');
          return res.json();
        })
        .then(function (data) {
          const session = normalizeSession(data);
          window.SV_AUTH = session;
          writeCache(session);
          dispatchAuthReady();
        })
        .catch(function (err) {
          console.warn('Auth bootstrap failed', err);
          // –ï—Å–ª–∏ –∫—ç—à–∞ –Ω–µ –±—ã–ª–æ –∏ –º—ã –≤—Å—ë –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã ‚Äî –æ—Å—Ç–∞—ë–º—Å—è –≥–æ—Å—Ç–µ–º
          if (!window.SV_AUTH.loaded) {
            const guest = normalizeSession({});
            window.SV_AUTH = guest;
            writeCache(guest);
            dispatchAuthReady();
          }
        });
    })();
  </script>

  <!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–ø–±–∞—Ä–∞/–º–µ–Ω—é –∫–∞–∫ –∏ —Ä–∞–Ω—å—à–µ -->
  <script type="module">
    import { initPage } from './js/topbar.module.js';
    initPage({
      fragments: [['menu.html', '#sidebar']],
      cacheBust: false,
      topbar: { state: { logoHref: 'index.html', logoSrc: 'assets/logo400.jpg' } }
    });
  </script>



</head>





<body>
<div id="page">
  <aside id="sidebar" aria-label="–û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é"></aside>
  <div id="app">
    <header id="topbar" role="banner"></header>
    <main id="main" role="main">
      
      
      <section class="about">
        <h1>–û –ø—Ä–æ–µ–∫—Ç–µ</h1>
        <p>SMART VISION ‚Äî –∫–æ–ª–ª–µ–∫—Ü–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –∏ —Å—Ç—Ä–∞–Ω–∏—Ü –ø—Ä–æ–µ–∫—Ç–∞..</p>
      </section>

<br>
<section class="card stack-16" aria-label="–†–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è">
  <h2>–†–∞–∑—Ä–µ—à–µ–Ω–∏—è</h2>

  <div class="stack-16">
    <button class="btn-purple" id="btnMic"  type="button">–†–∞–∑—Ä–µ—à–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω</button>
    <button class="btn-purple" id="btnCam"  type="button">–†–∞–∑—Ä–µ—à–∏—Ç—å –∫–∞–º–µ—Ä—É</button>
    <button class="btn-purple" id="btnNoti" type="button">–†–∞–∑—Ä–µ—à–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button>
    <button class="btn-purple" id="btnGeo"  type="button">–†–∞–∑—Ä–µ—à–∏—Ç—å –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é</button>
  </div>

  <p id="permStatus">status: idle</p>
</section>
  <br>
 <div id="home-geo-footer"></div>
  <br>
<section class="card stack-16" aria-label="–ò–Ω—Ñ–æ—Ä–º–µ—Ä">
  <h2>–ò–Ω—Ñ–æ—Ä–º–µ—Ä</h2>

  <!-- –í–ê–ñ–ù–û: informer.js –∏—â–µ—Ç #footer -->
  <div id="footer" class="informer-root"></div>

  <!-- –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–∫–ª—é—á–∞–µ–º —Å–∫—Ä–∏–ø—Ç -->
  <script defer src="js/informer.js"></script>
</section>
</main>

 <footer id="footer" role="contentinfo"></footer>


  </div>
</div>

<div id="overlay" hidden></div>

<!-- –æ–±—â–∏–µ —Å–∫—Ä–∏–ø—Ç—ã -->

<script defer src="js/footer.js?v=2"></script>
<!-- <script defer src="js/register-sw.js"></script> -->

<script defer src="about/about.js"></script>
<script defer src="js/zaprosrazreshenijbrauzera.js"></script>
<script defer src="js/footer.geo.bundle.js"></script>
  <script>
    window.addEventListener('DOMContentLoaded', function () {
      var targetId = 'home-geo-footer';
      if (window.SVFooter && document.getElementById(targetId)) {
        try { SVFooter.mount(targetId); } catch (e) { console.warn(e); }
      }
    });
  </script>






</body>
</html>
