<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>О проекте</title>

  <base href="/" />

  <!-- Основные стили -->
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/about/about.css" />
</head>

<body>
  <div id="page">
    <aside id="sidebar" aria-label="Основное меню"></aside>

    <div id="app">
      <header id="topbar"></header>

      <main id="main">

        <!-- КАРТОЧКА 0 -->
        <section class="card">
          <h1>О проекте</h1>
          <p>Диагностическая страница SMART VISION. Здесь можно проверить работу браузера, разрешения и параметры устройства.</p>
        </section>


        <!-- КАРТОЧКА 1: Разрешения -->
        <section class="card">
          <h2>Разрешения</h2>

          <div class="stack-16">
            <button class="btn-purple" id="btnMic">Разрешить микрофон</button>
            <button class="btn-purple" id="btnCam">Разрешить камеру</button>
            <button class="btn-purple" id="btnNoti">Разрешить уведомления</button>
            <button class="btn-purple" id="btnGeo">Разрешить геолокацию</button>
          </div>

          <p id="permStatus">status: idle</p>
        </section>


        <!-- КАРТОЧКА 2: Геолокация -->
        <section class="card">
          <h2>Геолокация</h2>
          <div id="geo-card"></div>

          <script>
            document.addEventListener("DOMContentLoaded", () => {
              try { SVFooter.mount("geo-card"); } 
              catch(e) { console.warn("geo mount:", e); }
            });
          </script>
        </section>


        <!-- КАРТОЧКА 3: Супер-информер -->
        <section class="card">
          <h2>Большой информер</h2>

          <div id="about-informer" class="big-informer">
            Загрузка супер-информера...
          </div>

          <script type="module">
            import { collectSuperInfo } from "/js/super-informer.js";

            async function renderSuper() {
              const info = await collectSuperInfo();

              const root = document.querySelector("#about-informer");
              if (!root) return;

              root.innerHTML = `
                ${block("SV_AUTH", info.svAuth)}
                ${block("Public IP", info.publicIP)}
                ${block("Permissions", info.permissions)}
                ${block("Battery", info.battery)}
                ${block("Device", info.device)}
                ${block("Screen", info.screen)}
                ${block("Network", info.network)}
                ${block("Storage", info.storage)}
                ${block("WebGL (GPU)", info.webgl)}
                ${block("Timestamp", info.timestamp)}
              `;
            }

            function block(title, data) {
              return `
                <div class="inf-group">
                  <h3>${title}</h3>
                  <pre>${JSON.stringify(data, null, 2)}</pre>
                </div>
              `;
            }

            document.addEventListener("sv:auth-ready", renderSuper);
          </script>
        </section>

      </main>

      <footer id="footer"></footer>
    </div>
  </div>

  <div id="overlay"></div>
<!-- 1. Глобальный инициализатор — рендер меню, футера, топбара -->
<script type="module" src="/js/smartid.init.js"></script>

<!-- 2. Супер-информер — модуль -->
<script type="module">
import { collectSuperInfo } from "/js/super-informer.js";

async function renderSuper() {
  const info = await collectSuperInfo();
  const root = document.querySelector("#about-informer");

  root.innerHTML = `
    ${block("SV_AUTH", info.svAuth)}
    ${block("Public IP", info.publicIP)}
    ${block("Permissions", info.permissions)}
    ${block("Battery", info.battery)}
    ${block("Device", info.device)}
    ${block("Screen", info.screen)}
    ${block("Storage", info.storage)}
    ${block("WebGL", info.webgl)}
    ${block("Network", info.network)}
    ${block("Timestamp", info.timestamp)}
  `;
}

function block(title, data) {
  return `
    <div class="inf-group">
      <h3>${title}</h3>
      <pre>${JSON.stringify(data, null, 2)}</pre>
    </div>
  `;
}

document.addEventListener("DOMContentLoaded", renderSuper);
</script>

<!-- 3. Старый JS — запросы разрешений (правильный — defer) -->
<script defer src="/js/zaprosrazreshenijbrauzera.js"></script>

<!-- 4. about.js — твой модуль -->
<script type="module" src="/about/about.js"></script>



<!-- FOOTER GEO WIDGET -->
<script defer src="/js/footer.geo.bundle.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    try {
      SVFooter.mount("geo-card"); 
    } catch(e) {
      console.warn("SVFooter mount error:", e);
    }
  });
</script>






</body>
</html>
