<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<base href="../" />
<title>О проекте</title>

<link rel="icon" href="assets/logo400.jpg" />
<link rel="manifest" href="manifest.json" />
<link rel="stylesheet" href="css/main.css" />
<link rel="stylesheet" href="about/about.css" />
  <script>
    (function () {
      // Значения по умолчанию: гость
      window.SV_AUTH = {
        isAuthenticated: false,
        userId: null,
        level: 1,
        levelCode: 'guest',
        email: null,
        displayName: null,
        loaded: false
      };

      function applySession(data) {
        window.SV_AUTH.isAuthenticated = !!data.is_authenticated;
        window.SV_AUTH.userId = data.user_id ?? null;
        window.SV_AUTH.level = data.level ?? 1;
        window.SV_AUTH.levelCode =
          data.level_code || (window.SV_AUTH.level === 1 ? 'guest' : 'user');
        window.SV_AUTH.email = data.email ?? null;
        window.SV_AUTH.displayName = data.display_name ?? null;
        window.SV_AUTH.loaded = true;

        // Сообщаем всем, что авторизация прогружена
        document.dispatchEvent(
          new CustomEvent('sv:auth-ready', { detail: window.SV_AUTH })
        );
      }

      // Тянем сессию с бэка
      fetch('/api/auth/session', {
        method: 'GET',
        credentials: 'include'
      })
        .then(function (res) {
          if (!res.ok) throw new Error('Auth check failed');
          return res.json();
        })
        .then(applySession)
        .catch(function () {
          // В случае ошибки остаёмся гостем
          applySession({});
        });
    })();
  </script>



</head>





<body>
<div id="page">
  <aside id="sidebar" aria-label="Основное меню"></aside>
  <div id="app">
    <header id="topbar" role="banner"></header>
    <main id="main" role="main">
      
      
      <section class="about">
        <h1>О проекте</h1>
        <p>SMART VISION — коллекция микросервисов и страниц проекта..</p>
      </section>

<br>
<section class="card stack-16" aria-label="Разрешения приложения">
  <h2>Разрешения</h2>

  <div class="stack-16">
    <button class="btn-purple" id="btnMic"  type="button">Разрешить микрофон</button>
    <button class="btn-purple" id="btnCam"  type="button">Разрешить камеру</button>
    <button class="btn-purple" id="btnNoti" type="button">Разрешить уведомления</button>
    <button class="btn-purple" id="btnGeo"  type="button">Разрешить геолокацию</button>
  </div>

  <p id="permStatus">status: idle</p>
</section>
  <br>
 <div id="home-geo-footer"></div>
  <br>
<section class="card stack-16" aria-label="Информер">
  <h2>Информер</h2>

  <!-- ВАЖНО: informer.js ищет #footer -->
  <div id="footer" class="informer-root"></div>

  <!-- просто подключаем скрипт -->
  <script defer src="js/informer.js"></script>
</section>
</main>

 <footer id="footer" role="contentinfo"></footer>


  </div>
</div>

<div id="overlay" hidden></div>

<!-- общие скрипты -->
<script defer src="svid/svid.js"></script>
<script defer src="js/footer.js?v=2"></script>
<!-- <script defer src="js/register-sw.js"></script> -->

<script defer src="about/about.js"></script>
<script defer src="js/zaprosrazreshenijbrauzera.js"></script>
<script defer src="js/footer.geo.bundle.js"></script>
  <script>
    window.addEventListener('DOMContentLoaded', function () {
      var targetId = 'home-geo-footer';
      if (window.SVFooter && document.getElementById(targetId)) {
        try { SVFooter.mount(targetId); } catch (e) { console.warn(e); }
      }
    });
  </script>



<!-- наш модуль: грузим ТОЛЬКО меню и рисуем топ-бар -->
<script type="module">
  import { initPage } from "./js/topbar.module.js";
  initPage({
    fragments: [["menu.html", "#sidebar"]],
    cacheBust: false,
    topbar: {
      state: { logoHref: "index.html", logoSrc: "assets/logo400.jpg", auth: { user: null } }
    }
  });
</script>


</body>
</html>
