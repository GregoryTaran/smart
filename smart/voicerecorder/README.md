# üéôÔ∏è VoiceRecorder ‚Äî Audio Capture & Segmenting Core

**VoiceRecorder** ‚Äî —ç—Ç–æ –º–æ–¥—É–ª—å–Ω—ã–π –≤–µ–±-–¥–∏–∫—Ç–æ—Ñ–æ–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ Web Audio API –∏ AudioWorklet.  
–û–Ω —É–º–µ–µ—Ç:
- –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∑–≤—É–∫ —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ (—Å –æ—Ç–∫–ª—é—á–∞–µ–º—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ AGC, AEC, NS),
- –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ä—É—á–Ω–æ–π –≥–µ–π–Ω (—É—Å–∏–ª–µ–Ω–∏–µ),
- –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É—Ä–æ–≤–Ω–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏,
- –Ω–∞—Ä–µ–∑–∞—Ç—å –ø–æ—Ç–æ–∫ –Ω–∞ –∫—É—Å–∫–∏ (2 —Å–µ–∫) –∏ —Å–æ–±–∏—Ä–∞—Ç—å –∏—Ç–æ–≥–æ–≤—ã–π WAV-—Ñ–∞–π–ª.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

/voicerecorder
‚îú‚îÄ‚îÄ voicerecorder.html ‚Üê –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îú‚îÄ‚îÄ voicerecorder.js ‚Üê –≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä UI
‚îú‚îÄ‚îÄ voicerecorder.css ‚Üê —Å—Ç–∏–ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îú‚îÄ‚îÄ /audiocore
‚îÇ ‚îú‚îÄ‚îÄ sv-audio-core.js ‚Üê —è–¥—Ä–æ: –º–∏–∫—Ä–æ—Ñ–æ–Ω + –≥–µ–π–Ω + worklet
‚îÇ ‚îú‚îÄ‚îÄ recorder.worklet.js‚Üê AudioWorkletProcessor (—Å–Ω–∏–º–∞–µ—Ç —á–∞–Ω–∫–∏ Float32)
‚îÇ ‚îú‚îÄ‚îÄ wav-segmenter.js ‚Üê —Ä–µ–∂–µ—Ç –ø–æ—Ç–æ–∫ –Ω–∞ –∫—É—Å–∫–∏ –ø–æ 2 —Å–µ–∫ (—Å –ø–∞–¥–¥–∏–Ω–≥–æ–º)
‚îÇ ‚îî‚îÄ‚îÄ wav-assembler.js ‚Üê —Å–æ–±–∏—Ä–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–π WAV –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ /mic-indicator ‚Üê –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç–∏
/uuid ‚Üê –≥–µ–Ω–µ—Ä–∞—Ü–∏—è user/session id

yaml
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

---

## ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ó–∞—Ö–≤–∞—Ç:**  
   `SVAudioCore` –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ü–µ–ø–æ—á–∫—É  
MediaStream ‚Üí GainNode ‚Üí AudioWorklet

markdown
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
–ì–µ–π–Ω (`VR_MANUAL_GAIN`) —É—Å–∏–ª–∏–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª.  
–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (—ç—Ö–æ/—à—É–º—ã/–∞–≤—Ç–æ–≥–µ–π–Ω) –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å –∏–ª–∏ –≤—ã–∫–ª—é—á–∞—Ç—å.

2. **–†–∞–±–æ—Ç–∞ —Å Worklet:**  
`recorder.worklet.js` –ø–æ–ª—É—á–∞–µ—Ç –∞—É–¥–∏–æ–ø–æ—Ç–æ–∫ –º–∞–ª–µ–Ω—å–∫–∏–º–∏ –±–ª–æ–∫–∞–º–∏ (–ø–æ 128 —Å—ç–º–ø–ª–æ–≤)  
–∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –∏—Ö –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ —á–µ—Ä–µ–∑ `port.postMessage`.

3. **–ù–∞—Ä–µ–∑–∫–∞:**  
`WavSegmenter` —Å–æ–±–∏—Ä–∞–µ—Ç —ç—Ç–∏ —á–∞–Ω–∫–∏ –≤ **—Ä–æ–≤–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã –ø–æ 2 —Å–µ–∫**,  
–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–∏ `stop()` –¥–æ–ø–æ–ª–Ω—è–µ—Ç —Ç–∏—à–∏–Ω–æ–π, —á—Ç–æ–±—ã –¥–ª–∏–Ω–∞ —Å–æ–≤–ø–∞–¥–∞–ª–∞.  
–ö–∞–∂–¥—ã–π —Å–µ–≥–º–µ–Ω—Ç –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

4. **–°–±–æ—Ä–∫–∞:**  
`WavAssembler` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π WAV-—Ñ–∞–π–ª.  
–ú–æ–∂–µ—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ—Å–µ–º–ø–ª–∏—Ä–æ–≤–∞—Ç—å –≤ `targetSampleRate` (–Ω–∞–ø—Ä–∏–º–µ—Ä, 16 –∫–ì—Ü).

5. **UI:**  
`voicerecorder.js` —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫–∞–º–∏ **Start / Pause / Stop**,  
–æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å, –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≥—Ä–æ–º–∫–æ—Å—Ç–∏ –∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–π —Ñ–∞–π–ª.

---

## üß© –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—É–¥–∏–æ (sv-audio-core.js)

```js
const VR_ECHO_CANCELLATION = false;  // Acoustic Echo Cancellation
const VR_NOISE_SUPPRESSION = false;  // Noise Suppression
const VR_AUTO_GAIN_CONTROL = false;  // Auto Gain Control (–º—ã –µ–≥–æ –æ—Ç–∫–ª—é—á–∞–µ–º)
const VR_MANUAL_GAIN      = 1.3;     // –†—É—á–Ω–æ–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É—Å–∏–ª–µ–Ω–∏—è
üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å
–†–∞–∑–º–µ—Å—Ç–∏ –≤—Å—ë –Ω–∞ –ª—é–±–æ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∏–ª–∏ —É–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ (–Ω—É–∂–µ–Ω HTTPS –¥–ª—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞).

–û—Ç–∫—Ä–æ–π /index.html.

–ù–∞–∂–º–∏ ¬´–û—Ç–∫—Ä—ã—Ç—å Voice Recorder¬ª ‚Üí –ø–æ—è–≤–∏—Ç—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

Start ‚Äî –∑–∞–ø–∏—Å—å, Pause ‚Äî –ø–∞—É–∑–∞, Stop ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ WAV.

üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
scss
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
üé§ Mic input
   ‚Üì
[SVAudioCore] ‚Üí GainNode(1.3√ó)
   ‚Üì
[AudioWorklet] ‚Üí Float32 chunks
   ‚Üì
[WavSegmenter] ‚Üí 2 —Å–µ–∫ PCM Int16 —Å–µ–≥–º–µ–Ω—Ç—ã
   ‚Üì
[WavAssembler] ‚Üí –ò—Ç–æ–≥–æ–≤—ã–π WAV (Blob)
üîß –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Whisper API / Speech-to-Text

‚öôÔ∏è –í–∏–∑—É–∞–ª—å–Ω—ã–π –≥–µ–π–Ω (–¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞)

üéöÔ∏è –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —Å–µ–≥–º–µ–Ω—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä (1‚Äì5 —Å–µ–∫)

üé® UI/PWA-–æ–±—ë—Ä—Ç–∫–∞ –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞