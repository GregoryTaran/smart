<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SMART VISION</title>

  <!-- –ï–î–ò–ù–´–ô –±–∞–∑–æ–≤—ã–π –ø—É—Ç—å –¥–ª—è –ø—Ä–æ–¥/–¥–µ–≤–∞ -->
  <base href="./" />

  <link rel="icon" href="assets/logo400.jpg" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="css/main.css" />
  <link rel="stylesheet" href="index/index.css" />

  <!--
    üß† –ì–ª–æ–±–∞–ª—å–Ω—ã–π bootstrap –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
    –î—ë—Ä–≥–∞–µ—Ç /api/auth/session, –∫–ª–∞–¥—ë—Ç –¥–∞–Ω–Ω—ã–µ –≤ window.SV_AUTH
    –∏ –∫–∏–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ 'sv:auth-ready' –¥–ª—è –≤—Å–µ—Ö, –∫–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ.
  -->
  <script>
    (function () {
      // –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –≥–æ—Å—Ç—å
      window.SV_AUTH = {
        isAuthenticated: false,
        userId: null,
        level: 1,
        levelCode: 'guest',
        email: null,
        displayName: null,
        loaded: false
      };

      function applySession(data) {
        window.SV_AUTH.isAuthenticated = !!data.is_authenticated;
        window.SV_AUTH.userId = data.user_id ?? null;
        window.SV_AUTH.level = data.level ?? 1;
        window.SV_AUTH.levelCode =
          data.level_code || (window.SV_AUTH.level === 1 ? 'guest' : 'user');
        window.SV_AUTH.email = data.email ?? null;
        window.SV_AUTH.displayName = data.display_name ?? null;
        window.SV_AUTH.loaded = true;

        // –°–æ–æ–±—â–∞–µ–º –≤—Å–µ–º, —á—Ç–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä—É–∂–µ–Ω–∞
        document.dispatchEvent(
          new CustomEvent('sv:auth-ready', { detail: window.SV_AUTH })
        );
      }

      // –¢—è–Ω–µ–º —Å–µ—Å—Å–∏—é —Å –±—ç–∫–∞
      fetch('/api/auth/session', {
        method: 'GET',
        credentials: 'include'
      })
        .then(function (res) {
          if (!res.ok) throw new Error('Auth check failed');
          return res.json();
        })
        .then(applySession)
        .catch(function () {
          // –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –æ—Å—Ç–∞—ë–º—Å—è –≥–æ—Å—Ç–µ–º
          applySession({});
        });
    })();
  </script>
</head>












<body>
  <div id="page">
    <aside id="sidebar" aria-label="–û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é"></aside>

    <div id="app">
      <header id="topbar" role="banner"></header>

      <main id="main" role="main">
        <section class="hero">
          <h1>SMART VISION</h1>
          <p>–ú–µ–Ω—é —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –ø–æ —É—Ä–æ–≤–Ω—é –∏–∑ SVID. –•–µ–¥–µ—Ä ‚Äî –æ–¥–∏–Ω –≤–ª–∞–¥–µ–ª–µ—Ü.</p>
        </section>
      </main>

      <div id="home-geo-footer"></div>
      <footer id="footer" role="contentinfo"></footer>
    </div>
  </div>
  <div id="overlay" hidden></div>

  

  <script defer src="js/footer.js?v=2"></script>
  <script defer src="index/index.js"></script>

  <!-- 2) –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞: —Ö–µ–¥–µ—Ä/–º–µ–Ω—é (–º–æ–¥—É–ª—å) -->
  <script type="module">
    import { initPage } from './js/topbar.module.js';
    initPage({
      fragments: [['menu.html', '#sidebar']],
      cacheBust: false,
      topbar: { state: { logoHref: 'index.html', logoSrc: 'assets/logo400.jpg' } }
    });
  </script>

</body>
</html>
