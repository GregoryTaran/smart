<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- БАЗА ДЛЯ ВСЕХ ПУТЕЙ ВНУТРИ /smart -->
  <base href="../" />

  <title>SMART VISION — Вход (SVID)</title>

  <link rel="icon" href="assets/logo400.jpg" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="css/main.css" />
  <link rel="stylesheet" href="login/login.css" />
</head>
<body>
  <div id="page">
    <aside id="sidebar" aria-label="Основное меню"></aside>
    <div id="app">
      <header id="topbar" role="banner"></header>

      <main id="main" role="main">
        <section class="login">
          <div class="login__box sv-center-700">
            <h1 class="login__title">SMART VISION — SVID</h1>
            <p class="login__lead">Единая идентификация: регистрация, вход, сброс — всё на одной странице.</p>

            <!-- Общий статус -->
            <div class="login__status" id="svid-status" role="status" aria-live="polite"></div>

            <!-- ===== Состояние: РЕГИСТРАЦИЯ ===== -->
            <form class="login__form" id="svid-form-register" data-svid-form="register" novalidate>
              <label class="login__label" for="reg-name">
                Имя
                <input class="login__input" id="reg-name" name="name" type="text"
                       placeholder="Ваше имя" required />
              </label>

              <label class="login__label" for="reg-email">
                Email
                <!-- type=text: проверяем только наличие @ в login.js -->
                <input class="login__input" id="reg-email" name="email" type="text"
                       placeholder="you@example.com" required />
              </label>

              <label class="login__label" for="reg-pass">
                Пароль
                <input class="login__input" id="reg-pass" name="password" type="password"
                       placeholder="Пароль" required />
              </label>

              <button class="login__btn" id="btn-register" type="submit">Зарегистрироваться</button>

              <div class="login__links">
                <button class="login__link" id="switch-to-login" type="button" data-action="to-login">Войти</button>
                <button class="login__link" id="switch-to-reset" type="button" data-action="to-reset">Сбросить пароль</button>
              </div>
            </form>

            <!-- ===== Состояние: ВХОД ===== -->
            <form class="login__form" id="svid-form-login" data-svid-form="login" hidden novalidate>
              <label class="login__label" for="login-email">
                Email
                <input class="login__input" id="login-email" name="email" type="text"
                       placeholder="you@example.com" required />
              </label>

              <label class="login__label" for="login-pass">
                Пароль
                <input class="login__input" id="login-pass" name="password" type="password"
                       placeholder="Пароль" required />
              </label>

              <button class="login__btn" id="btn-login" type="submit">Войти</button>

              <div class="login__links">
                <button class="login__link" id="switch-to-register-1" type="button" data-action="to-register">Назад к регистрации</button>
                <button class="login__link" id="switch-to-reset-1" type="button" data-action="to-reset">Сбросить пароль</button>
              </div>
            </form>

            <!-- ===== Состояние: СБРОС ПАРОЛЯ ===== -->
            <form class="login__form" id="svid-form-reset" data-svid-form="reset" hidden novalidate>
              <label class="login__label" for="reset-email">
                Email
                <input class="login__input" id="reset-email" name="email" type="text"
                       placeholder="you@example.com" required />
              </label>

              <button class="login__btn" id="btn-reset-password" type="submit">Получить пароль</button>
              <p class="micro-hint">После нажатия ниже на этой странице покажем новый пароль.</p>

              <div class="login__links">
                <button class="login__link" id="switch-to-register-2" type="button" data-action="to-register">Назад к регистрации</button>
              </div>

              <!-- сюда выводим сгенерированный пароль -->
              <div class="login__status" id="reset-result" role="status" aria-live="polite"></div>
            </form>
          </div>
        </section>
      </main>

      <footer id="footer" role="contentinfo"></footer>
    </div>
  </div>

  <!-- Оверлей для мобильного меню -->
  <div id="overlay" hidden></div>

  <script defer src="svid/svid.js"></script>
  <script defer src="js/footer.js?v=2"></script>
  <!-- <script defer src="js/register-sw.js"></script> -->
  <script defer src="login/login.js"></script>

  <!-- ==== Модуль: грузим меню и рисуем топ-бар ==== -->
  <script type="module">
    import { initPage } from "./js/topbar.module.js";
    initPage({
      fragments: [
        ["menu.html", "#sidebar"]
      ],
      cacheBust: false,
      topbar: {
        state: {
          logoHref: "index.html",
          logoSrc:  "assets/logo400.jpg",
          auth:     { user: null }
        }
      }
    });
  </script>
</body>
</html>
