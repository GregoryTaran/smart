ФАЙЛ: smartid.init.js  
РОЛЬ: ГЛАВНЫЙ КЛИЕНТСКИЙ “АВТО-ЗАПУСКАТЕЛЬ” АВТОРИЗАЦИИ И ИНТЕРФЕЙСА

ГДЕ РАБОТАЕТ:
• Этот файл подключён на КАЖДОЙ странице сайта (в layout / шаблоне).
• Он запускается автоматически сразу после загрузки страницы.

ЗАЧЕМ НУЖЕН:
• Чтобы любая страница, куда заходит пользователь, сразу знала:
    – Авторизован он или нет  
    – Какая у него роль / уровень доступа  
    – Его email / user_id  
• Чтобы отрисовать интерфейс (меню, топбар, футер) с учётом его статуса.

----------------------------------------------
1) КАЖДЫЙ РАЗ, КОГДА ПОЛЬЗОВАТЕЛЬ ОТКРЫВАЕТ ЛЮБУЮ СТРАНИЦУ:
----------------------------------------------
Файл автоматически делает запрос:

   GET /api/auth/me

Это запрос на сервер, который проверяет:
   → есть ли у пользователя активная сессия  
   → авторизован ли он  
   → какой у него уровень (level)  
   → кто он вообще  

Почему это важно?
• Потому что на клиенте мы НЕ храним авторизацию в localStorage или cookies вручную — всё идёт через серверную сессию.
• Этот запрос — “источник истины” для UI.

----------------------------------------------
2) ПОЛУЧАЕМ РЕЗУЛЬТАТ И ОБНОВЛЯЕМ ГЛОБАЛЬНОЕ СОСТОЯНИЕ
----------------------------------------------
После ответа сервера создаётся глобальный объект:

   window.SMART_SESSION = { ... }

То есть:
✓ Любая часть фронтенда может мгновенно узнать статус пользователя  
✓ Топбар, меню, футер, страницы — всё использует один источник данных

Это как “центральная авторизационная модель” на клиенте.

----------------------------------------------
3) ПОЧЕМУ ФАЙЛ НА КАЖДОЙ СТРАНИЦЕ?
----------------------------------------------
Потому что:
• интерфейс на каждой странице разный;
• меню и топбар показывают разные кнопки для гостя и для авторизованного;
• некоторые страницы вообще нельзя показывать без авторизации.

Этот файл гарантирует:
→ Переходишь на любую страницу — интерфейс сразу знает, кто ты.  
→ Не авторизован — можно скрыть часть UI или перекинуть на вход.  
→ Авторизован — загрузить нужные секции.

----------------------------------------------
4) ДИНАМИЧЕСКАЯ ЗАГРУЗКА МОДУЛЕЙ ПОСЛЕ ПРОВЕРКИ
----------------------------------------------
После того как статус определён, файл подгружает интерфейс:

• /js/topbar.module.js  
• /js/footer.js  

Почему динамически?
• Чтобы уменьшить базовый вес страницы  
• И чтобы эти модули получили уже Готовую сессию (session)

В topbar.module.js делается:
   - отрисовка логотипа
   - кнопки входа / выхода
   - борь с меню (левое меню)
   - логика открытия/закрытия меню

В footer.js:
   - проблема решения стандартного футера с данными пользователя.

----------------------------------------------
5) ИТОГОВОЕ ОБЪЯСНЕНИЕ НОРМАЛЬНЫМ ЯЗЫКОМ:
----------------------------------------------
Этот файл — как “первый охранник”, который стоит **на входе любой страницы**:

• Проверяет: «Ты кто?»  
• Сверяет с сервером: «Ты действительно этот пользователь?»  
• Выдаёт клиенту инфу о пользователе.  
• Строит интерфейс вокруг результата.  
• Обеспечивает одинаковую авторизацию на любых страницах.

----------------------------------------------
6) КОРОЧЕ:
----------------------------------------------
БЕЗ ЭТОГО ФАЙЛА:
• Каждая страница бы не знала, авторизован ли пользователь  
• Пришлось бы вручную подгружать меню / топбар на каждой странице  
• Не было бы единой глобальной сессии

С ЭТИМ ФАЙЛОМ:
• Статус пользователя узнаётся мгновенно  
• Интерфейс строится динамически под него  
• На любой новой странице мы сразу знаем, кто зашёл и что ему показывать
