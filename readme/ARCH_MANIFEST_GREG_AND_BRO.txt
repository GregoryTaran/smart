Манифест Грега и Бро: как мы кодим
0. Главный принцип

Сначала — чтобы работало просто и не ломалось.
Красиво и «по учебнику» — потом.

Если решение усложняет MVP → мы его выкидываем.

1. Простота > Архитектурная дрочка

Никакого кода «на 3 года вперёд». Только то, что нужно сейчас.

Минимум сущностей, минимум уровней абстракции.

Каждый модуль маленький, простой и понятный.

Никаких «магических» зависимостей.

2. База данных — мягкая, терпимая, не ломает жизнь

Минимум NOT NULL, только реально необходимые поля.

Таблица ничего не должна «обязывать» — всё, что можно хранить гибко, храним гибко.

Если провайдер ничего не вернул — запись всё равно вставляется.

Имена таблиц = имена модулей.
Один модуль — одно имя. Всегда.

3. Код модулей — чистый, маленький, без магии

Минимальные зависимости.

Структура модуля:

backend/
  <module_name>/
    __init__.py
    service.py
    <module_name>_description.txt


__init__.py работает по правилам:

если нужен красивый импорт — экспортируем нужные функции;

если не нужен — оставляем пустым.

Рядом с модулем — простой текстовый файл с описанием:

зачем модуль;

какие поля в таблице;

как вызывать.

4. Логика vs База

Сложная логика — в коде (FastAPI/Python).

База — это хранилище фактов, а не система наказания.

Ограничения, биллинг, лимиты — только в коде, не в схеме.

5. Идентификаторы: user, visitor, кто угодно

Мы не привязаны жёстко к user_id.

Есть логин → clientid = user_id, clienttype = "user".

Нет логина → clientid = visitor_id, clienttype = "visitor".

Системные операции → clientid = None / "system".

6. Как мы создаём новый модуль (эталон)

Придумали имя → оно же имя папки → оно же имя таблицы → оно же имя описания.

Создали таблицу с минимальной схемой и гибкими полями (TEXT, JSONB, INTEGER, всё опционально).

Создали service.py — маленький, простой.

Создали description.txt — человеческое описание.

Подключили модуль, когда он реально нужен.

7. Формула утреннего приветствия

Ты мне пишешь:

«Привет Бро, работаем по манифесту:
просто, понятно, минимум обязательств,
минимум NOT NULL,
один модуль — одно имя,
никаких архитектурных драконов.
Делаем, чтобы работало и было ясно мне завтра.»