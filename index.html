<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Smart Vision</title>
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#ffffff" />
  <link rel="icon" href="/icons/icon-192.png" />
  <style>
    body { display:flex; flex-direction:column; align-items:center; justify-content:flex-start; min-height:100vh; padding-top:60px; background:#f5f5f5; font-family:system-ui,sans-serif; color:#222; margin:0; text-align:center; }
    #topSection { margin-bottom:60px; }
    button { padding:14px 30px; font-size:18px; font-weight:600; border:none; border-radius:12px; cursor:pointer; transition:0.25s; }
    #installBtn { background:#000; color:#fff; } #installBtn:hover { background:#333; }
    #openBtn { background:#008f3e; color:#fff; } #openBtn:hover { background:#00a54a; }
    #contextBtn { background:#fff; color:#000; border:2px solid #000; margin-top:2rem; }
    #contextBtn:hover { background:#e9e9e9; }
    h1 { font-size:1.6rem; margin-bottom:0.5rem; }
    p { line-height:1.6; max-width:400px; color:#444; margin:0.3rem 0; }
    footer { margin-top:40px; color:#777; font-size:0.9rem; }
  </style>
</head>
<body>
  <div id='topSection'>
    <p id='statusText'>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
    <button id='installBtn' style='display:none;'>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
    <div id='installedControls' style='display:none;'>
      <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–¥–µ—Å—å ‚úÖ</p>
      <button id='openBtn'>–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
    </div>
  </div>
  <h1>Smart Vision</h1>
  <p>–õ—é–±–∞—è –º—ã—Å–ª—å –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –≤–∏–∑–∏–µ–π.</p>
  <p>–õ—é–±–∞—è –≤–∏–∑–∏—è –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –¥–æ—Ä–æ–≥–æ–π.</p>
  <p>–ê –¥–æ—Ä–æ–≥–∞ ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–≤–µ—Ç–∞.</p>
  <button id='contextBtn'>–ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É</button>
  <button id="goToProjectBtn" style="margin-top:20px;background:#007BFF;color:white;border:none;border-radius:12px;padding:14px 30px;font-size:18px;">–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–æ–µ–∫—Ç—É</button> <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç -->
  <button id='testNotifyBtn' style='margin-top:20px;background:#fff;color:#000;border:2px solid #000;border-radius:10px;padding:12px 24px;font-size:16px;cursor:pointer;'>üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –í—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã!</button>
  <footer>–ì—Ä–µ–≥ –¢–∞—Ä–∞–Ω | 2025</footer>
  <script>
    const installBtn=document.getElementById('installBtn'),installedControls=document.getElementById('installedControls'),openBtn=document.getElementById('openBtn'),contextBtn=document.getElementById('contextBtn'),statusText=document.getElementById('statusText'),contextUrl='/context.html';let deferredPrompt;
    if('serviceWorker'in navigator)navigator.serviceWorker.register('/service-worker.js');
    const isPWA=window.matchMedia('(display-mode: standalone)').matches||window.navigator.standalone===true;
    if(isPWA){document.getElementById('topSection').style.display='none';}else{statusText.textContent='Smart Vision –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ';}
    window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();deferredPrompt=e;if(!isPWA){installBtn.style.display='inline-block';statusText.textContent='–ú–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ';}});
    installBtn.addEventListener('click',async()=>{if(!deferredPrompt)return;deferredPrompt.prompt();const{outcome}=await deferredPrompt.userChoice;if(outcome==='accepted'){statusText.textContent='‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ';installBtn.style.display='none';installedControls.style.display='block';}else{statusText.textContent='‚ùå –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞';}deferredPrompt=null;});
    openBtn.addEventListener('click',()=>window.location.href=contextUrl);contextBtn.addEventListener('click',()=>window.location.href=contextUrl);
    if(window.matchMedia('(display-mode: standalone)').matches){const perm=Notification.permission,notifSection=document.createElement('div');notifSection.style.marginTop='1.5rem';notifSection.style.textAlign='center';notifSection.style.maxWidth='400px';notifSection.style.color='#555';
      if(perm==='default'){const btn=document.createElement('button');btn.textContent='üîî –í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è';btn.style='padding:12px 20px;font-size:16px;background:#000;color:#fff;border:none;border-radius:10px;cursor:pointer;';btn.onclick=async()=>{const permission=await Notification.requestPermission();if(permission==='granted'){new Notification('Smart Vision',{body:'–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã ‚úÖ',icon:'/icons/icon-192.png'});notifSection.innerHTML='<p>‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã</p>';}else if(permission==='denied'){showDeniedMessage();}};notifSection.appendChild(btn);}
      else if(perm==='granted'){notifSection.innerHTML='<p>‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã</p>';}
      else if(perm==='denied'){showDeniedMessage();}
      document.body.appendChild(notifSection);
      function showDeniedMessage(){notifSection.innerHTML='<p>üîï –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞.<br>–ß—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å ‚Äî –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∞–π—Ç–∞ ‚Üí <b>¬´–†–∞–∑—Ä–µ—à–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è¬ª</b>.</p><button id="openSettingsBtn">–û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é</button>';const btn=notifSection.querySelector('#openSettingsBtn');btn.style='margin-top:10px;background:#ddd;color:#333;border:none;border-radius:8px;padding:8px 16px;font-size:14px;cursor:pointer;';btn.onclick=()=>{alert('–ü–µ—Ä–µ–π–¥–∏ –≤ –∞–¥—Ä–µ—Å–Ω—É—é —Å—Ç—Ä–æ–∫—É ‚Üí –∑–Ω–∞—á–æ–∫ –∑–∞–º–∫–∞ ‚Üí –†–∞–∑—Ä–µ—à–µ–Ω–∏—è ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Üí –†–∞–∑—Ä–µ—à–∏—Ç—å');};}}
    const testBtn=document.getElementById('testNotifyBtn');if(testBtn){testBtn.addEventListener('click',async()=>{if(Notification.permission==='granted'){new Notification('Smart Vision',{body:'–í—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã! üí´',icon:'/icons/icon-192.png'});}else if(Notification.permission==='default'){const perm=await Notification.requestPermission();if(perm==='granted'){new Notification('Smart Vision',{body:'–í—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã! üí´',icon:'/icons/icon-192.png'});}else{alert('–†–∞–∑—Ä–µ—à–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —á—Ç–æ–±—ã —É—Å–ª—ã—à–∞—Ç—å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç üòâ');}}else{alert('üîï –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã. –†–∞–∑—Ä–µ—à–∏ –∏—Ö –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞.');}});}
    
    // –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç
    document.getElementById('goToProjectBtn').addEventListener('click', function() {
      window.location.href = '/smart';  // –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É –≤ –ø–∞–ø–∫–µ smart
    });
  </script>
</body>
</html>
